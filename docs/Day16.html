<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Day16</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption empty">&nbsp;</span><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Day16</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>General - Main problem here is that the input file is difficult
 to parse. I broke it up into 3 files (-ranges, -your, -nearby)
 and parse these files seperately.</p><p>Part 1 - After that we just have to filter out the invalid codes
 from all codes (given by the nearby tickes).</p><p>Part 2 - This was ... difficult. No big algorithms involved. Just
 a lot of careful reading and the realisation that finding the colums
 is recursive (not unique, when you do it in one go). This was also
 difficult because you where able to make the testcases pass with a
 much simpler implementation and then it was hard to understand/see
 why it is not working for the puzzle input.</p><p>But first things first: Let's define data-structures/terminology ...</p><ul><li>The input has three parts: the ranges of numbers that describe
   a valid field (or column; see below)</li><li>The/My ticket. Every number is a field. We need to find out how
   to associate these numbers with the ranges above</li><li>Nearby tickets to intersect with ranges to find out which field/column
   belongs to which range</li><li>You want to end up with a mapping of range-name to column-number</li></ul><p>Now let's talk about the algorithm ...</p><ul><li>This problem can be solved by building intersections of number
   sets (we only need any (not empty intersection) and all (full/complete
   intersection))</li><li>First we need to find all valid tickets. That's kinda easy. We just
   take the invalid fields from part1 and remove the tickets that have
   an invalid field in it</li><li>Now the real work starts</li><li>Next we need to realize that we need to look at the valid (nearby)
   tickets column by column (and need to find out which column fits/matches
   which range)</li><li>This should be easy, right? We just intersect the column with the ranges
   and if all the numbers in the column are in the range we have a match</li><li>This is when things get tricky. Because this is not the case. The match
   is not unique. Means a column will match with multiple ranges</li><li>BUT ... one of the columns will match with exactly one range. And that's
   the one you are looking for. You then have your first mapping of a
   range-name to a column-number</li><li>You then need to remove the range from the ranges and the column from
   the columns and do it again (recursively, until no more ranges/columns
   need to be mapped</li><li>When you are done with the mapping you can just lookup/select the
   6 column-numbers, lookup the 6 numbers in your ticket and multiply
   them</li><li>Done </li></ul></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">type</span> <a href="#t:Description">Description</a> = String</li><li class="src short"><span class="keyword">type</span> <a href="#t:Field">Field</a> = Int</li><li class="src short"><span class="keyword">type</span> <a href="#t:Ranges">Ranges</a> = Map <a href="Day16.html#t:Description" title="Day16">Description</a> [<a href="Day16.html#t:Field" title="Day16">Field</a>]</li><li class="src short"><span class="keyword">type</span> <a href="#t:Ticket">Ticket</a> = [<a href="Day16.html#t:Field" title="Day16">Field</a>]</li><li class="src short"><span class="keyword">type</span> <a href="#t:Column">Column</a> = Int</li><li class="src short"><span class="keyword">type</span> <a href="#t:Columns">Columns</a> = Map <a href="Day16.html#t:Column" title="Day16">Column</a> [<a href="Day16.html#t:Field" title="Day16">Field</a>]</li><li class="src short"><span class="keyword">type</span> <a href="#t:Mappings">Mappings</a> = Map <a href="Day16.html#t:Description" title="Day16">Description</a> <a href="Day16.html#t:Column" title="Day16">Column</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:Notes">Notes</a> = <a href="#v:Notes">Notes</a> <a href="Day16.html#t:Ranges" title="Day16">Ranges</a> <a href="Day16.html#t:Ticket" title="Day16">Ticket</a> [<a href="Day16.html#t:Ticket" title="Day16">Ticket</a>]</li><li class="src short"><a href="#v:input">input</a> :: String -&gt; <a href="Day16.html#t:Notes" title="Day16">Notes</a></li><li class="src short"><a href="#v:invalidFields">invalidFields</a> :: <a href="Day16.html#t:Notes" title="Day16">Notes</a> -&gt; [<a href="Day16.html#t:Field" title="Day16">Field</a>]</li><li class="src short"><a href="#v:part1">part1</a> :: <a href="Day16.html#t:Notes" title="Day16">Notes</a> -&gt; Int</li><li class="src short"><a href="#v:validTickets">validTickets</a> :: [<a href="Day16.html#t:Field" title="Day16">Field</a>] -&gt; [<a href="Day16.html#t:Ticket" title="Day16">Ticket</a>] -&gt; [<a href="Day16.html#t:Ticket" title="Day16">Ticket</a>]</li><li class="src short"><a href="#v:check">check</a> :: [<a href="Day16.html#t:Field" title="Day16">Field</a>] -&gt; <a href="Day16.html#t:Columns" title="Day16">Columns</a> -&gt; [(Int, Bool)]</li><li class="src short"><a href="#v:checks">checks</a> :: <a href="Day16.html#t:Ranges" title="Day16">Ranges</a> -&gt; <a href="Day16.html#t:Columns" title="Day16">Columns</a> -&gt; [(<a href="Day16.html#t:Description" title="Day16">Description</a>, [(<a href="Day16.html#t:Column" title="Day16">Column</a>, Bool)])]</li><li class="src short"><a href="#v:unique">unique</a> :: [(<a href="Day16.html#t:Description" title="Day16">Description</a>, [(<a href="Day16.html#t:Column" title="Day16">Column</a>, Bool)])] -&gt; (<a href="Day16.html#t:Description" title="Day16">Description</a>, <a href="Day16.html#t:Column" title="Day16">Column</a>)</li><li class="src short"><a href="#v:collect">collect</a> :: <a href="Day16.html#t:Ranges" title="Day16">Ranges</a> -&gt; <a href="Day16.html#t:Columns" title="Day16">Columns</a> -&gt; <a href="Day16.html#t:Mappings" title="Day16">Mappings</a> -&gt; <a href="Day16.html#t:Mappings" title="Day16">Mappings</a></li><li class="src short"><a href="#v:solve">solve</a> :: String -&gt; <a href="Day16.html#t:Notes" title="Day16">Notes</a> -&gt; [Int]</li><li class="src short"><a href="#v:part2">part2</a> :: <a href="Day16.html#t:Notes" title="Day16">Notes</a> -&gt; Int</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Description" class="def">Description</a> = String <a href="#t:Description" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Field" class="def">Field</a> = Int <a href="#t:Field" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Ranges" class="def">Ranges</a> = Map <a href="Day16.html#t:Description" title="Day16">Description</a> [<a href="Day16.html#t:Field" title="Day16">Field</a>] <a href="#t:Ranges" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Ticket" class="def">Ticket</a> = [<a href="Day16.html#t:Field" title="Day16">Field</a>] <a href="#t:Ticket" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Column" class="def">Column</a> = Int <a href="#t:Column" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Columns" class="def">Columns</a> = Map <a href="Day16.html#t:Column" title="Day16">Column</a> [<a href="Day16.html#t:Field" title="Day16">Field</a>] <a href="#t:Columns" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Mappings" class="def">Mappings</a> = Map <a href="Day16.html#t:Description" title="Day16">Description</a> <a href="Day16.html#t:Column" title="Day16">Column</a> <a href="#t:Mappings" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Notes" class="def">Notes</a> <a href="#t:Notes" class="selflink">#</a></p><div class="doc"><p>The note that describes the ticket. </p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Notes" class="def">Notes</a> <a href="Day16.html#t:Ranges" title="Day16">Ranges</a> <a href="Day16.html#t:Ticket" title="Day16">Ticket</a> [<a href="Day16.html#t:Ticket" title="Day16">Ticket</a>]</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:Notes">Instances</h4><details id="i:Notes" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Notes:Eq:1"></span> Eq <a href="Day16.html#t:Notes" title="Day16">Notes</a></span> <a href="#t:Notes" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Notes:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Day16.html">Day16</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Day16.html#t:Notes" title="Day16">Notes</a> -&gt; <a href="Day16.html#t:Notes" title="Day16">Notes</a> -&gt; Bool</p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Day16.html#t:Notes" title="Day16">Notes</a> -&gt; <a href="Day16.html#t:Notes" title="Day16">Notes</a> -&gt; Bool</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Notes:Show:2"></span> Show <a href="Day16.html#t:Notes" title="Day16">Notes</a></span> <a href="#t:Notes" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Notes:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Day16.html">Day16</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="Day16.html#t:Notes" title="Day16">Notes</a> -&gt; ShowS</p><p class="src"><a href="#v:show">show</a> :: <a href="Day16.html#t:Notes" title="Day16">Notes</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Day16.html#t:Notes" title="Day16">Notes</a>] -&gt; ShowS</p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:input" class="def">input</a> :: String -&gt; <a href="Day16.html#t:Notes" title="Day16">Notes</a> <a href="#v:input" class="selflink">#</a></p><div class="doc"><p>Read the input file.</p></div></div><div class="top"><p class="src"><a id="v:invalidFields" class="def">invalidFields</a> :: <a href="Day16.html#t:Notes" title="Day16">Notes</a> -&gt; [<a href="Day16.html#t:Field" title="Day16">Field</a>] <a href="#v:invalidFields" class="selflink">#</a></p><div class="doc"><p>Returns the invalid fields.</p></div></div><div class="top"><p class="src"><a id="v:part1" class="def">part1</a> :: <a href="Day16.html#t:Notes" title="Day16">Notes</a> -&gt; Int <a href="#v:part1" class="selflink">#</a></p><div class="doc"><p>Solve part1.</p></div></div><div class="top"><p class="src"><a id="v:validTickets" class="def">validTickets</a> :: [<a href="Day16.html#t:Field" title="Day16">Field</a>] -&gt; [<a href="Day16.html#t:Ticket" title="Day16">Ticket</a>] -&gt; [<a href="Day16.html#t:Ticket" title="Day16">Ticket</a>] <a href="#v:validTickets" class="selflink">#</a></p><div class="doc"><p>Returns the valid tickets.</p></div></div><div class="top"><p class="src"><a id="v:check" class="def">check</a> :: [<a href="Day16.html#t:Field" title="Day16">Field</a>] -&gt; <a href="Day16.html#t:Columns" title="Day16">Columns</a> -&gt; [(Int, Bool)] <a href="#v:check" class="selflink">#</a></p><div class="doc"><p>Check for a given range, which cols are valid.</p></div></div><div class="top"><p class="src"><a id="v:checks" class="def">checks</a> :: <a href="Day16.html#t:Ranges" title="Day16">Ranges</a> -&gt; <a href="Day16.html#t:Columns" title="Day16">Columns</a> -&gt; [(<a href="Day16.html#t:Description" title="Day16">Description</a>, [(<a href="Day16.html#t:Column" title="Day16">Column</a>, Bool)])] <a href="#v:checks" class="selflink">#</a></p><div class="doc"><p>Checks for all ranges, which cols are valid.</p></div></div><div class="top"><p class="src"><a id="v:unique" class="def">unique</a> :: [(<a href="Day16.html#t:Description" title="Day16">Description</a>, [(<a href="Day16.html#t:Column" title="Day16">Column</a>, Bool)])] -&gt; (<a href="Day16.html#t:Description" title="Day16">Description</a>, <a href="Day16.html#t:Column" title="Day16">Column</a>) <a href="#v:unique" class="selflink">#</a></p><div class="doc"><p>Find the one col, that can be uniquely mapped to a range. </p></div></div><div class="top"><p class="src"><a id="v:collect" class="def">collect</a> :: <a href="Day16.html#t:Ranges" title="Day16">Ranges</a> -&gt; <a href="Day16.html#t:Columns" title="Day16">Columns</a> -&gt; <a href="Day16.html#t:Mappings" title="Day16">Mappings</a> -&gt; <a href="Day16.html#t:Mappings" title="Day16">Mappings</a> <a href="#v:collect" class="selflink">#</a></p><div class="doc"><p>(Recursively) Collect all of the col indexes.</p></div></div><div class="top"><p class="src"><a id="v:solve" class="def">solve</a> :: String -&gt; <a href="Day16.html#t:Notes" title="Day16">Notes</a> -&gt; [Int] <a href="#v:solve" class="selflink">#</a></p><div class="doc"><p>Returns the fields for the word.</p></div></div><div class="top"><p class="src"><a id="v:part2" class="def">part2</a> :: <a href="Day16.html#t:Notes" title="Day16">Notes</a> -&gt; Int <a href="#v:part2" class="selflink">#</a></p><div class="doc"><p>Solve part2.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.23.0</p></div></body></html>